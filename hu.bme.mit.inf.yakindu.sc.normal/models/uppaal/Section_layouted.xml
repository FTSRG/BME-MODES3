<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>typedef int[0,2] directions;

const int STRAIGHT = 0;
const int DIVERGENT = 1;
const int TOP = 2;

broadcast chan syncChan1;
broadcast chan syncChan2;

broadcast chan sectionLockedTo[3];
broadcast chan lockRequestTo[3];
broadcast chan sectionOccupied[3];
broadcast chan sectionLockFrom[3];
broadcast chan passingAllowedFrom[3];
broadcast chan passingDeniedFrom[3];
broadcast chan sectionLockedWithReplyTo[3];
broadcast chan sectionAllowedTo[3];

broadcast chan enableSection[3];   // ez a szakasztól jön a környezet felé
broadcast chan disableSection[3];  // ez a szakasztól jön a környezet felé

broadcast chan revokeLock[3];  // ez a környezettől jön a szakasz felé
broadcast chan sectionFree[3]; // ez a környezettől jön a szakasz felé
	</declaration><template><name>mainregionOfStatechart</name><parameter>const directions dir</parameter><declaration>bool isActive = true;</declaration><location id="id0" x="168" y="-968"><name x="158" y="-998">initial</name><label kind="comments">Initial entry node</label><committed/></location><location id="id1" x="639" y="-962"><name x="629" y="-992">FreeSection</name><label kind="comments">Simple state</label></location><location id="id2" x="785" y="-488"><name x="775" y="-518">OccupiedSection</name><label kind="comments">Composite state</label></location><location id="id3" x="509" y="-654"><name x="499" y="-684">EntryLocationOfOccupiedSection1</name><committed/></location><location id="id4" x="1027" y="-14"><name x="1017" y="-44">Raise_passingAllowedFrom6</name><committed/></location><location id="id5" x="946" y="-168"><name x="936" y="-198">Raise_enableSection12</name><committed/></location><location id="id6" x="116" y="-808"><name x="106" y="-838">Raise_passingDeniedFrom14</name><committed/></location><location id="id7" x="503" y="-808"><name x="493" y="-838">Raise_passingAllowedFrom15</name><committed/></location><location id="id8" x="1152" y="-960"><name x="1142" y="-990">Raise_passingAllowedFrom18</name><committed/></location><location id="id9" x="848" y="-322"><name x="838" y="-352">triggerLocation1</name><committed/></location><init ref="id0"/><transition><source ref="id1"/><target ref="id6"/><label kind="guard" x="174" y="-892">isActive</label><label kind="synchronisation" x="174" y="-877">sectionOccupied[dir]?</label><nail x="600" y="-953"/><nail x="510" y="-927"/><nail x="288" y="-862"/><nail x="179" y="-831"/></transition><transition><source ref="id2"/><target ref="id9"/><label kind="guard" x="856" y="-392">isActive</label><label kind="synchronisation" x="856" y="-376">sectionFree[dir]?</label><nail x="792" y="-474"/><nail x="803" y="-445"/><nail x="825" y="-387"/><nail x="838" y="-353"/></transition><transition><source ref="id0"/><target ref="id1"/><label kind="guard" x="232" y="-1000">isActive</label></transition><transition><source ref="id3"/><target ref="id2"/><label kind="synchronisation" x="712" y="-569">syncChan1!</label><nail x="538" y="-640"/><nail x="588" y="-610"/><nail x="694" y="-547"/><nail x="750" y="-514"/></transition><transition><source ref="id4"/><target ref="id1"/><label kind="synchronisation" x="1096" y="-488">passingAllowedFrom[dir]!</label><nail x="1030" y="-36"/><nail x="1040" y="-126"/><nail x="1085" y="-522"/><nail x="1085" y="-522"/><nail x="1085" y="-522"/><nail x="757" y="-848"/><nail x="664" y="-941"/></transition><transition><source ref="id5"/><target ref="id4"/><label kind="synchronisation" x="872" y="-112">enableSection[dir]!</label><nail x="956" y="-153"/><nail x="970" y="-127"/><nail x="997" y="-76"/><nail x="1013" y="-45"/></transition><transition><source ref="id6"/><target ref="id3"/><label kind="synchronisation" x="438" y="-723">passingDeniedFrom[dir]!</label><nail x="158" y="-795"/><nail x="230" y="-767"/><nail x="379" y="-709"/><nail x="458" y="-678"/></transition><transition><source ref="id1"/><target ref="id7"/><label kind="synchronisation" x="440" y="-888">sectionLockedWithReplyTo[dir]?</label><nail x="625" y="-948"/><nail x="601" y="-921"/><nail x="554" y="-869"/><nail x="526" y="-837"/></transition><transition><source ref="id7"/><target ref="id1"/><label kind="synchronisation" x="464" y="-872">passingAllowedFrom[dir]!</label><nail x="519" y="-830"/><nail x="543" y="-856"/><nail x="590" y="-909"/><nail x="618" y="-940"/></transition><transition><source ref="id1"/><target ref="id8"/><label kind="synchronisation" x="832" y="-984">lockRequestTo[dir]?</label></transition><transition><source ref="id8"/><target ref="id1"/><label kind="synchronisation" x="832" y="-1024">passingAllowedFrom[dir]!</label><nail x="1152" y="-1000"/><nail x="656" y="-1000"/></transition><transition><source ref="id9"/><target ref="id5"/><label kind="synchronisation" x="947" y="-237">syncChan2!</label><nail x="859" y="-308"/><nail x="876" y="-281"/><nail x="910" y="-229"/><nail x="930" y="-198"/></transition></template><template><name>r1OfOccupiedSection</name><parameter> const directions dir</parameter><declaration>bool isActive = false;</declaration><location id="id10" x="194" y="-180"><name x="184" y="-210">initial</name><label kind="comments">Initial entry node</label><committed/></location><location id="id11" x="1144" y="-358"><name x="1134" y="-388">SendSectionLock</name><label kind="comments">Simple state</label></location><location id="id12" x="1545" y="-1224"><name x="1535" y="-1254">EnableSection</name><label kind="comments">Simple state</label></location><location id="id13" x="849" y="-714"><name x="839" y="-744">BecomesLocked</name><label kind="comments">Simple state</label></location><location id="id14" x="59" y="-358"><name x="49" y="-388">GeneratedInit</name></location><location id="id15" x="849" y="-892"><name x="839" y="-922">Raise_passingDeniedFrom1</name><committed/></location><location id="id16" x="1964" y="-180"><name x="1954" y="-210">Raise_enableSection2</name><committed/></location><location id="id17" x="1911" y="-14"><name x="1901" y="-44">Raise_disableSection3</name><committed/></location><location id="id18" x="1766" y="-981"><name x="1756" y="-1011">Raise_sectionLockFrom4</name><committed/></location><location id="id19" x="1128" y="-981"><name x="1118" y="-1011">Raise_disableSection5</name><committed/></location><location id="id20" x="386" y="-180"><name x="376" y="-210">Raise_disableSection7</name><committed/></location><location id="id21" x="1212" y="-536"><name x="1202" y="-566">Raise_sectionLockFrom8</name><committed/></location><location id="id22" x="849" y="-1058"><name x="839" y="-1088">Raise_disableSection9</name><committed/></location><location id="id23" x="1233" y="-180"><name x="1223" y="-210">Raise_passingDeniedFrom10</name><committed/></location><location id="id24" x="1444" y="-536"><name x="1434" y="-566">Raise_sectionLockFrom11</name><committed/></location><location id="id25" x="556" y="-14"><name x="546" y="-44">Raise_sectionLockFrom13</name><committed/></location><location id="id26" x="1615" y="-180"><name x="1605" y="-210">Raise_passingDeniedFrom16</name><committed/></location><location id="id27" x="1832" y="-1058"><name x="1822" y="-1088">Raise_passingDeniedFrom17</name><committed/></location><location id="id28" x="518" y="-358"><name x="508" y="-388">Raise_disableSection19</name><committed/></location><location id="id29" x="613" y="-536"><name x="603" y="-566">Raise_passingDeniedFrom20</name><committed/></location><location id="id30" x="861" y="-358"><name x="851" y="-388">Raise_passingDeniedFrom21</name><committed/></location><location id="id31" x="993" y="-536"><name x="983" y="-566">Raise_disableSection22</name><committed/></location><location id="id32" x="974" y="-180"><name x="964" y="-210">Raise_sectionLockFrom23</name><committed/></location><init ref="id14"/><transition><source ref="id12"/><target ref="id22"/><label kind="guard" x="848" y="-1136">isActive</label><label kind="synchronisation" x="792" y="-1112">sectionLockedWithReplyTo[dir]?</label><nail x="1499" y="-1215"/><nail x="1378" y="-1187"/><nail x="1055" y="-1111"/><nail x="916" y="-1078"/></transition><transition><source ref="id11"/><target ref="id20"/><label kind="guard" x="586" y="-276">isActive</label><label kind="synchronisation" x="586" y="-261">sectionLockedTo[dir]?</label><nail x="1092" y="-348"/><nail x="958" y="-317"/><nail x="602" y="-235"/><nail x="453" y="-200"/></transition><transition><source ref="id13"/><target ref="id21"/><label kind="guard" x="1128" y="-624">isActive</label><label kind="synchronisation" x="1128" y="-608">revokeLock[dir]?</label><nail x="881" y="-701"/><nail x="946" y="-670"/><nail x="1096" y="-597"/><nail x="1170" y="-561"/></transition><transition><source ref="id13"/><target ref="id24"/><label kind="guard" x="1144" y="-672">isActive</label><label kind="synchronisation" x="1128" y="-656">sectionAllowedTo[dir]?</label><nail x="894" y="-703"/><nail x="1000" y="-672"/><nail x="1264" y="-594"/><nail x="1384" y="-558"/></transition><transition><source ref="id10"/><target ref="id25"/><label kind="guard" x="424" y="-120">isActive</label><nail x="217" y="-172"/><nail x="276" y="-145"/><nail x="433" y="-74"/><nail x="511" y="-39"/></transition><transition><source ref="id11"/><target ref="id16"/><label kind="guard" x="1728" y="-280">isActive</label><label kind="synchronisation" x="1720" y="-264">sectionAllowedTo[dir]?</label><nail x="1198" y="-349"/><nail x="1342" y="-318"/><nail x="1735" y="-234"/><nail x="1895" y="-199"/></transition><transition><source ref="id12"/><target ref="id18"/><label kind="guard" x="1632" y="-1104">isActive</label><label kind="synchronisation" x="1624" y="-1088">revokeLock[dir]?</label><nail x="1545" y="-1209"/><nail x="1545" y="-1192"/><nail x="1545" y="-1169"/><nail x="1545" y="-1169"/><nail x="1545" y="-1169"/><nail x="1677" y="-1059"/><nail x="1737" y="-1009"/></transition><transition><source ref="id12"/><target ref="id19"/><label kind="guard" x="1375" y="-1142">isActive</label><label kind="synchronisation" x="1375" y="-1127">sectionLockedTo[dir]?</label><nail x="1542" y="-1209"/><nail x="1535" y="-1176"/><nail x="1522" y="-1109"/><nail x="1522" y="-1109"/><nail x="1522" y="-1109"/><nail x="1297" y="-1038"/><nail x="1187" y="-1003"/></transition><transition><source ref="id11"/><target ref="id23"/><label kind="guard" x="1200" y="-272">isActive</label><label kind="synchronisation" x="1168" y="-256">sectionLockedWithReplyTo[dir]?</label><nail x="1153" y="-343"/><nail x="1169" y="-312"/><nail x="1202" y="-247"/><nail x="1220" y="-211"/></transition><transition><source ref="id14"/><target ref="id10"/><label kind="synchronisation" x="101" y="-261">syncChan1?</label><label kind="assignment" x="101" y="-246">isActive = true</label><nail x="72" y="-344"/><nail x="96" y="-312"/><nail x="149" y="-244"/><nail x="176" y="-208"/></transition><transition><source ref="id12"/><target ref="id10"/><label kind="synchronisation" x="197" y="-706">syncChan1?</label><label kind="assignment" x="197" y="-691">isActive = true</label><nail x="1509" y="-1213"/><nail x="1299" y="-1126"/><nail x="238" y="-688"/><nail x="238" y="-688"/><nail x="238" y="-688"/><nail x="206" y="-318"/><nail x="197" y="-212"/></transition><transition><source ref="id11"/><target ref="id10"/><label kind="synchronisation" x="370" y="-261">syncChan1?</label><label kind="assignment" x="370" y="-246">isActive = true</label><nail x="1087" y="-350"/><nail x="910" y="-317"/><nail x="378" y="-219"/><nail x="232" y="-191"/></transition><transition><source ref="id13"/><target ref="id10"/><label kind="synchronisation" x="235" y="-439">syncChan1?</label><label kind="assignment" x="235" y="-424">isActive = true</label><nail x="818" y="-701"/><nail x="698" y="-639"/><nail x="276" y="-421"/><nail x="276" y="-421"/><nail x="276" y="-421"/><nail x="225" y="-273"/><nail x="204" y="-211"/></transition><transition><source ref="id12"/><target ref="id12"/><label kind="synchronisation" x="1669" y="-1216">syncChan2?</label><label kind="assignment" x="1669" y="-1201">isActive = false</label><nail x="1580" y="-1243"/><nail x="1603" y="-1247"/><nail x="1626" y="-1242"/><nail x="1626" y="-1228"/><nail x="1626" y="-1215"/><nail x="1609" y="-1210"/><nail x="1590" y="-1211"/></transition><transition><source ref="id11"/><target ref="id11"/><label kind="synchronisation" x="1240" y="-384">syncChan2?</label><label kind="assignment" x="1256" y="-368">isActive = false</label><nail x="1186" y="-377"/><nail x="1212" y="-381"/><nail x="1238" y="-376"/><nail x="1238" y="-362"/><nail x="1238" y="-349"/><nail x="1218" y="-344"/><nail x="1196" y="-345"/></transition><transition><source ref="id13"/><target ref="id13"/><label kind="synchronisation" x="944" y="-744">syncChan2?</label><label kind="assignment" x="944" y="-720">isActive = false</label><nail x="889" y="-733"/><nail x="914" y="-737"/><nail x="939" y="-732"/><nail x="939" y="-718"/><nail x="939" y="-705"/><nail x="921" y="-700"/><nail x="899" y="-701"/></transition><transition><source ref="id15"/><target ref="id13"/><label kind="synchronisation" x="784" y="-832">passingDeniedFrom[dir]!</label><nail x="849" y="-877"/><nail x="849" y="-847"/><nail x="849" y="-783"/><nail x="849" y="-746"/></transition><transition><source ref="id16"/><target ref="id12"/><label kind="synchronisation" x="2096" y="-856">enableSection[dir]!</label><nail x="1972" y="-202"/><nail x="2013" y="-298"/><nail x="2205" y="-748"/><nail x="2205" y="-748"/><nail x="2205" y="-748"/><nail x="1708" y="-1109"/><nail x="1577" y="-1205"/></transition><transition><source ref="id17"/><target ref="id13"/><label kind="synchronisation" x="1736" y="-496">disableSection[dir]!</label><nail x="1919" y="-36"/><nail x="1950" y="-110"/><nail x="2066" y="-392"/><nail x="2066" y="-392"/><nail x="2066" y="-392"/><nail x="1152" y="-636"/><nail x="908" y="-702"/></transition><transition><source ref="id18"/><target ref="id11"/><label kind="synchronisation" x="1808" y="-816">sectionLockFrom[dir]!</label><nail x="1789" y="-967"/><nail x="1860" y="-912"/><nail x="2069" y="-748"/><nail x="2069" y="-748"/><nail x="2069" y="-748"/><nail x="1380" y="-460"/><nail x="1191" y="-381"/></transition><transition><source ref="id19"/><target ref="id13"/><label kind="synchronisation" x="1024" y="-880">disableSection[dir]!</label><nail x="1108" y="-967"/><nail x="1089" y="-949"/><nail x="1062" y="-926"/><nail x="1062" y="-926"/><nail x="1062" y="-926"/><nail x="932" y="-798"/><nail x="875" y="-743"/></transition><transition><source ref="id20"/><target ref="id13"/><label kind="synchronisation" x="340" y="-439">disableSection[dir]!</label><nail x="386" y="-202"/><nail x="385" y="-257"/><nail x="381" y="-421"/><nail x="381" y="-421"/><nail x="381" y="-421"/><nail x="705" y="-626"/><nail x="814" y="-695"/></transition><transition><source ref="id21"/><target ref="id11"/><label kind="synchronisation" x="1136" y="-480">sectionLockFrom[dir]!</label><nail x="1206" y="-521"/><nail x="1194" y="-490"/><nail x="1169" y="-426"/><nail x="1155" y="-389"/></transition><transition><source ref="id22"/><target ref="id15"/><label kind="synchronisation" x="856" y="-1016">disableSection[dir]!</label><nail x="849" y="-1043"/><nail x="849" y="-1015"/><nail x="849" y="-958"/><nail x="849" y="-924"/></transition><transition><source ref="id23"/><target ref="id17"/><label kind="synchronisation" x="1632" y="-104">passingDeniedFrom[dir]!</label><nail x="1293" y="-168"/><nail x="1420" y="-137"/><nail x="1714" y="-66"/><nail x="1846" y="-34"/></transition><transition><source ref="id24"/><target ref="id11"/><label kind="synchronisation" x="1312" y="-504">sectionLockFrom[dir]!</label><nail x="1416" y="-522"/><nail x="1361" y="-490"/><nail x="1241" y="-419"/><nail x="1180" y="-384"/></transition><transition><source ref="id25"/><target ref="id11"/><label kind="synchronisation" x="664" y="-152">sectionLockFrom[dir]!</label><nail x="593" y="-35"/><nail x="671" y="-71"/><nail x="847" y="-154"/><nail x="847" y="-154"/><nail x="847" y="-154"/><nail x="1034" y="-284"/><nail x="1111" y="-338"/></transition><transition><source ref="id11"/><target ref="id26"/><label kind="synchronisation" x="1448" y="-248">lockRequestTo[dir]?</label><nail x="1183" y="-346"/><nail x="1268" y="-314"/><nail x="1468" y="-239"/><nail x="1564" y="-204"/></transition><transition><source ref="id26"/><target ref="id11"/><label kind="synchronisation" x="1416" y="-264">passingDeniedFrom[dir]!</label><nail x="1573" y="-200"/><nail x="1485" y="-233"/><nail x="1285" y="-308"/><nail x="1193" y="-342"/></transition><transition><source ref="id12"/><target ref="id27"/><label kind="synchronisation" x="1800" y="-1144">lockRequestTo[dir]?</label><nail x="1572" y="-1211"/><nail x="1623" y="-1182"/><nail x="1735" y="-1118"/><nail x="1794" y="-1084"/></transition><transition><source ref="id27"/><target ref="id12"/><label kind="synchronisation" x="1808" y="-1128">passingDeniedFrom[dir]!</label><nail x="1803" y="-1079"/><nail x="1750" y="-1109"/><nail x="1638" y="-1173"/><nail x="1581" y="-1206"/></transition><transition><source ref="id13"/><target ref="id29"/><label kind="synchronisation" x="640" y="-608">sectionLockedWithReplyTo[dir]?</label><nail x="828" y="-700"/><nail x="785" y="-669"/><nail x="692" y="-599"/><nail x="644" y="-563"/></transition><transition><source ref="id28"/><target ref="id13"/><label kind="synchronisation" x="437" y="-528">disableSection[dir]!</label><nail x="513" y="-380"/><nail x="503" y="-419"/><nail x="478" y="-510"/><nail x="478" y="-510"/><nail x="478" y="-510"/><nail x="716" y="-643"/><nail x="811" y="-696"/></transition><transition><source ref="id29"/><target ref="id28"/><label kind="synchronisation" x="560" y="-480">passingDeniedFrom[dir]!</label><nail x="604" y="-521"/><nail x="587" y="-490"/><nail x="552" y="-425"/><nail x="532" y="-389"/></transition><transition><source ref="id13"/><target ref="id31"/><label kind="synchronisation" x="912" y="-608">lockRequestTo[dir]?</label><nail x="863" y="-700"/><nail x="889" y="-668"/><nail x="943" y="-602"/><nail x="973" y="-565"/></transition><transition><source ref="id30"/><target ref="id13"/><label kind="synchronisation" x="822" y="-528">passingDeniedFrom[dir]!</label><nail x="863" y="-380"/><nail x="868" y="-419"/><nail x="878" y="-510"/><nail x="878" y="-510"/><nail x="878" y="-510"/><nail x="861" y="-632"/><nail x="853" y="-689"/></transition><transition><source ref="id31"/><target ref="id30"/><label kind="synchronisation" x="936" y="-480">disableSection[dir]!</label><nail x="981" y="-522"/><nail x="957" y="-491"/><nail x="908" y="-424"/><nail x="880" y="-388"/></transition><transition><source ref="id11"/><target ref="id32"/><label kind="synchronisation" x="1021" y="-261">revokeLock[dir]?</label><nail x="1128" y="-344"/><nail x="1098" y="-312"/><nail x="1032" y="-245"/><nail x="998" y="-209"/></transition><transition><source ref="id32"/><target ref="id11"/><label kind="synchronisation" x="1024" y="-280">sectionLockFrom[dir]!</label><nail x="991" y="-201"/><nail x="1021" y="-233"/><nail x="1086" y="-300"/><nail x="1121" y="-336"/></transition></template><system>system mainregionOfStatechart, r1OfOccupiedSection;
</system></nta>